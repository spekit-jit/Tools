<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
<title>tools</title><meta name="color-scheme" content="light dark" />
<style>
  :root{ --bg:#0f1220; --panel:#14182a; --ink:#e9ecf8; --shadow:0 16px 40px rgba(0,0,0,.38) }
  @media (prefers-color-scheme: light){ :root{ --bg:#f6f7fb; --panel:#fff; --ink:#0f1426; --shadow:0 18px 40px rgba(12,24,60,.08) } }
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;color:var(--ink);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
       background:radial-gradient(1200px 520px at 0% -10%, rgba(110,86,207,.25), transparent 60%),
                  radial-gradient(900px 360px at 110% 0%, rgba(69,231,179,.20), transparent 60%),var(--bg);
       display:flex;align-items:stretch;justify-content:center}
  .board{width:100%;max-width:1100px;margin:16px;padding:16px;background:var(--panel);
         border:1px solid rgba(255,255,255,.08);border-radius:18px;box-shadow:var(--shadow)}
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:12px}
  @media (max-width:980px){.grid{grid-template-columns:repeat(8,1fr)}}
  @media (max-width:640px){.grid{grid-template-columns:repeat(2,1fr)}}
  a.tool{grid-column:span 3;display:inline-flex;align-items:center;justify-content:center;text-decoration:none;text-align:center;
         padding:14px 12px;min-height:56px;border-radius:14px;color:#fff;font-weight:700;letter-spacing:.2px;
         border:1px solid rgba(255,255,255,.12);box-shadow:0 12px 26px rgba(0,0,0,.25);
         transition:transform .06s,box-shadow .12s;word-break:break-word;backdrop-filter:saturate(110%)}
  @media (max-width:980px){a.tool{grid-column:span 4}} @media (max-width:640px){a.tool{grid-column:span 2}}
  a.tool:hover{transform:translateY(-1px);box-shadow:0 14px 30px rgba(0,0,0,.30)}
  .tiny{margin-top:10px;font:12px/1.3 ui-monospace,monospace;color:#9aa3bf;text-align:center;opacity:.85}
</style>
</head>
<body>
  <div class="board">
    <div id="grid" class="grid"></div>
    <div id="note" class="tiny"></div>
  </div>

<script>
/* --------- Explicit repo --------- */
const OWNER = "spekit-jit";
const REPO  = "spekit-jit.github.io";

/* Try common Pages branches, then detect default if needed */
const BRANCH_CANDIDATES = ["gh-pages", "main", "master"];
/* Some repos serve from /docs. Weâ€™ll try both roots. */
const ROOTS = ["tools", "docs/tools"];

/* UI helpers */
const grid = document.getElementById("grid");
const note = document.getElementById("note");
function hash(s){let h=2166136261>>>0;for(let i=0;i<s.length;i++){h^=s.charCodeAt(i);h=Math.imul(h,16777619)}return h>>>0}
function hue(name){return hash(name)%360}
function emoji(name){const e=["âœ¨","ðŸš€","ðŸ§©","ðŸ› ï¸","âš¡","ðŸ“Š","ðŸ§ ","ðŸ“Ž","ðŸŽ¯","ðŸ§ª","ðŸ“","ðŸ—‚ï¸","ðŸ”§","ðŸ“","ðŸ§­","ðŸ’¡","ðŸª„","ðŸ”—","ðŸ–‡ï¸","ðŸ“Œ"];return e[hash(name)%e.length]}
function label(s){return s.replace(/\.html?$/i,'')}
function btn(path, displayName){
  const a=document.createElement("a"); const h=hue(path);
  a.className="tool";
  a.href = path; a.target="_blank"; a.rel="noopener";
  a.style.background = `linear-gradient(180deg, hsl(${h} 75% 46%), hsl(${(h+24)%360} 78% 44%))`;
  a.textContent = label(displayName) + " " + emoji(displayName);
  a.title = displayName;
  return a;
}
function render(files, ctx){
  grid.innerHTML = "";
  files.sort((a,b)=>a.name.localeCompare(b.name))
       .forEach(f => grid.appendChild(btn(f.href, f.name)));
  note.textContent = `${files.length} file(s) â€¢ branch: ${ctx.branch} â€¢ root: ${ctx.root}`;
}

/* Trees API for a given branch */
async function fetchTree(branch){
  const url = `https://api.github.com/repos/${OWNER}/${REPO}/git/trees/${encodeURIComponent(branch)}?recursive=1&cb=${Date.now()}`;
  const res = await fetch(url, {cache:"no-store", headers:{"Accept":"application/vnd.github+json"}});
  if(!res.ok) throw new Error(`trees ${branch} ${res.status}`);
  return res.json();
}

/* Try branches/roots until we find html files */
(async ()=>{
  try {
    // first, try our candidates
    const branchesToTry = [...BRANCH_CANDIDATES];
    let data = null, branchUsed = null;

    while (branchesToTry.length) {
      const b = branchesToTry.shift();
      try { data = await fetchTree(b); branchUsed = b; if (data && data.tree) break; } catch(_) {}
    }

    // if still no tree, try to detect default branch
    if (!data || !data.tree) {
      const repoRes = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}`, {headers:{"Accept":"application/vnd.github+json"}});
      if(!repoRes.ok) throw new Error("repo meta "+repoRes.status);
      const meta = await repoRes.json();
      branchUsed = meta.default_branch || "main";
      data = await fetchTree(branchUsed);
    }

    if (!data || !data.tree) throw new Error("no tree");

    // scan two possible roots
    let picked = null;
    for (const root of ROOTS) {
      const files = data.tree
        .filter(n => n.type === "blob" && new RegExp(`^${root.replace('/','\\/')}\\/[^/]+\\.(html?|HTML?)$`).test(n.path))
        .map(n => ({
          name: n.path.split('/').pop(),
          href: `${location.origin}/${root}/${encodeURIComponent(n.path.split('/').pop())}`
        }))
        .filter(f => !/^index\.html?$/i.test(f.name));
      if (files.length) { picked = {files, root}; break; }
    }

    if (!picked) {
      note.textContent = `0 file(s) â€¢ checked branches: ${branchUsed} â€¢ roots: ${ROOTS.join(", ")}`;
      return;
    }
    render(picked.files, {branch: branchUsed, root: picked.root});
  } catch (e) {
    note.textContent = "Couldnâ€™t list tools â€¢ " + (e.message || e);
  }
})();
</script>
</body>
</html>
